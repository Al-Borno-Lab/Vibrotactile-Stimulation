Bootstrap: docker
From: continuumio/miniconda3:22.11.1-alpine

%post
    apk update
    apk --no-cache add ca-certificates openssl
    update-ca-certificates
    apk --no-cache add wget vim git
    apk --no-cache add build-base gcc
    wget -q https://repo.anaconda.com/miniconda/Miniconda3-py310_23.1.0-1-Linux-x86_64.sh -O /opt/miniconda.sh
    bash /opt/miniconda.sh -b -p /opt/miniconda3


    /opt/miniconda3/bin/conda create -y -n vibro -c conda-forge python=3.10 \
                                                        numpy \
                                                        scipy \
                                                        numba \
                                                        cython \
                                                        jupyter \
                                                        ipython \
                                                        multiprocess \
                                                        boost \
                                                        matplotlib \
                                                        mpmath \
                                                        blas=*=openblas \
                                                        pip \
                                                        jax
    /opt/miniconda3/bin/conda init bash
    echo -e "\nconda activate vibro" >> ~/.bashrc
    /opt/conda/bin/conda env list
 
%runscript