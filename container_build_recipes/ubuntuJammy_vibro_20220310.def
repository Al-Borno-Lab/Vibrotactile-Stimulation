Bootstrap: docker
From: ubuntu:jammy

%help
Singularity container built upon the Docker's Ubuntu LTS Jammy image.

%setup

%files

%labels
    Maintainer "Anthony Lee"
    MaintainerContact "anthony.y.lee@ucdenver.edu"
    Version v0.0.1

%environment

%post
    # Install wget
    apt-get update
    apt-get -y install wget

    # Install conda
    wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/Miniconda3_Python3_10.sh
    bash ~/Miniconda3_Python3_10.sh -b -p $HOME/miniconda3
    rm ~/Miniconda3_Python3_10.sh

    # Edit path and update Conda
    export PATH=~/miniconda3/bin:$PATH
    conda update conda

    # Install new environment
    conda create --yes -n vibro python=3.10
    # conda init bash  # No change
    . ~/miniconda3/etc/profile.d/conda.sh  # Source functions
    #ps  # Trying to figure out whether sh or bash is used
    conda activate vibro
    conda config --env --add channels conda-forge
    conda install --yes numpy=1.24 scipy=1.10
    conda install --yes matplotlib=3.7
    conda install --yes tqdm=4.65
    #conda install --yes jax=0.4.4
    conda install --yes jax=0.4

%runscript

%test